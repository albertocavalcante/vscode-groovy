"use strict";(()=>{(function(){let p=acquireVsCodeApi(),a={ast:null,parser:"core"},c=document.getElementById("tree-container"),i=document.getElementById("details-container"),l=document.getElementById("parser-select"),C=document.getElementById("btn-refresh"),m=document.getElementById("btn-export");l&&l.addEventListener("change",()=>{a.parser=l.value,p.postMessage({type:"refresh",parser:a.parser})}),C&&C.addEventListener("click",()=>{p.postMessage({type:"refresh",parser:a.parser})}),m&&m.addEventListener("click",()=>{if(a.ast){let e=JSON.stringify(a.ast,null,2);navigator.clipboard.writeText(e).then(()=>{m.textContent="Copied!",setTimeout(()=>m.textContent="Export JSON",2e3)})}}),window.addEventListener("message",e=>{let s=e.data;switch(s.type){case"updateAst":a.ast=s.ast,a.parser=s.parser,l&&(l.value=s.parser),y();break;case"error":if(c){c.innerHTML="";let n=document.createElement("div");n.className="empty-state",n.textContent=s.message,c.appendChild(n)}i&&(i.textContent="Select a node to view details");break}});function y(){if(!c)return;if(!a.ast){c.innerHTML='<div class="empty-state">No AST available</div>';return}c.innerHTML="";let e=E(a.ast);c.appendChild(e)}function E(e){let s=document.createElement("div");s.className="tree-node",s.dataset.id=e.id;let n=document.createElement("div");if(n.className="node-content",e.children&&e.children.length>0){let t=document.createElement("span");t.className="node-toggle codicon codicon-chevron-right",t.onclick=r=>{r.stopPropagation(),s.classList.toggle("expanded"),t.classList.toggle("codicon-chevron-down"),t.classList.toggle("codicon-chevron-right")},n.appendChild(t),n.onclick=()=>{s.classList.toggle("expanded"),t.classList.toggle("codicon-chevron-down"),t.classList.toggle("codicon-chevron-right"),v(e)}}else{let t=document.createElement("span");t.className="node-spacer",n.appendChild(t),n.onclick=()=>v(e)}let d=document.createElement("span");d.className=`node-icon codicon ${L(e.type)}`,n.appendChild(d);let o=document.createElement("span");if(o.className="node-label",o.textContent=e.type,n.appendChild(o),e.properties&&e.properties.name){let t=document.createElement("span");t.className="node-name",t.textContent=e.properties.name,n.appendChild(t)}if(s.appendChild(n),e.children&&e.children.length>0){let t=document.createElement("div");t.className="node-children",e.children.forEach(r=>{t.appendChild(E(r))}),s.appendChild(t)}return s}function v(e){if(!i)return;document.querySelectorAll(".node-content.selected").forEach(r=>r.classList.remove("selected"));let s=CSS.escape(e.id),n=c.querySelector(`[data-id="${s}"] > .node-content`);n&&n.classList.add("selected"),i.innerHTML="";let d=document.createElement("h3");d.textContent=e.type,i.appendChild(d);let o=document.createElement("table");o.className="details-table";let t=(r,u)=>{let g=document.createElement("tr"),h=document.createElement("td");h.className="key",h.textContent=r;let f=document.createElement("td");f.className="value",f.textContent=u,g.appendChild(h),g.appendChild(f),o.appendChild(g)};if(t("ID",e.id),e.range&&t("Range",`${e.range.startLine}:${e.range.startColumn} - ${e.range.endLine}:${e.range.endColumn}`),e.properties)for(let[r,u]of Object.entries(e.properties))t(r,String(u));i.appendChild(o),e.range&&p.postMessage({type:"highlight",range:e.range})}function L(e){return e.includes("Class")?"codicon-symbol-class":e.includes("Method")?"codicon-symbol-method":e.includes("Field")?"codicon-symbol-field":e.includes("Property")?"codicon-symbol-property":e.includes("Import")?"codicon-symbol-interface":"codicon-symbol-misc"}p.postMessage({type:"ready"})})();})();
